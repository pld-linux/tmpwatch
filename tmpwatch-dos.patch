diff -bruN tmpwatch-2.2/tmpwatch.c tmpwatch-2.2.limit/tmpwatch.c
--- tmpwatch-2.2/tmpwatch.c	Mon Feb 14 20:54:56 2000
+++ tmpwatch-2.2.limit/tmpwatch.c	Sat Sep  9 22:54:59 2000
@@ -36,6 +36,9 @@
 
 int logLevel = LOG_NORMAL;
 
+int number_of_tasks = 0;
+#define TASK_NUMBER_LIMIT	500
+
 void message(int level, char * format, ...) {
   va_list args;
   FILE * where = stdout;
@@ -116,11 +119,21 @@
      of stack, not bad). I should probably just keep a directory stack
      and fchdir() back up it, but it's not worth changing now. */
   
+  if(number_of_tasks > TASK_NUMBER_LIMIT) {
+	  message(LOG_ERROR, "already %u tasks running, won't start more\n",
+			  number_of_tasks);
+	  message(LOG_ERROR, "this can be a denial of service attempt or"
+			  " a very deep directory tree - inspect and clean"
+			  " manually if neccessary\n");
+	 return(1);
+  }
+  
   pid = fork();
   if (pid == (pid_t)-1) {
     message(LOG_ERROR, "cannot fork: %s", strerror(errno));
     return(1);
   } else if (pid == (pid_t)0) {
+    number_of_tasks++;
     if (safe_chdir(dirname)) exit(1);
     if ( (dir = opendir(".")) == (DIR *)0 ) {
       message(LOG_ERROR, "opendir error on current directory %s: %s",
